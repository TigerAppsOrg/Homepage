---
import { Image } from "astro:assets";
import GithubIcon from "../../../assets/icons/github-mark.svg";
import type { AppProps } from "../../../utils/types";
import { categoryColors } from "../../../utils/apps";

interface Props extends AppProps {
    delay?: number;
}

const {
    title,
    description,
    webLink,
    repoLink,
    screenshot,
    alt,
    category,
    delay = 0
} = Astro.props;

const colors = categoryColors[category] || categoryColors["Campus Life"];
---

<article
    class="group bg-white rounded-xl border-2 border-transparent hover:border-current shadow-pop hover:shadow-pop-hover transition-all duration-200 overflow-hidden animate-fade-in-up"
    style={`animation-delay: ${delay}s; --tw-text-opacity: 0.15; color: ${colors.accent}`}>
    <div class="flex gap-4 p-4">
        <!-- Thumbnail -->
        <a
            href={webLink}
            target="_blank"
            class="shrink-0 w-24 h-24 sm:w-32 sm:h-24 rounded-lg overflow-hidden bg-light">
            <Image
                src={screenshot}
                {alt}
                class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
            />
        </a>

        <!-- Content -->
        <div class="flex-1 min-w-0">
            <a href={webLink} target="_blank" class="block">
                <h4
                    class="font-bold text-charcoal group-hover:text-pixar-blue transition-colors truncate"
                    style={`--hover-color: ${colors.accent}`}>
                    {title}
                </h4>
            </a>
            <p class="text-sm text-gray-dark mt-1 line-clamp-2">
                {description}
            </p>

            <!-- Actions -->
            <div class="flex items-center gap-3 mt-3">
                <a
                    href={webLink}
                    target="_blank"
                    class="inline-flex items-center gap-1.5 text-xs font-semibold px-3 py-1.5 rounded-full transition-all duration-200"
                    style={`background-color: ${colors.accent}20; color: ${colors.accent}`}>
                    <svg
                        class="w-3.5 h-3.5"
                        fill="none"
                        viewBox="0 0 24 24"
                        stroke="currentColor"
                        stroke-width="2.5">
                        <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            d="M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"
                        ></path>
                    </svg>
                    Open
                </a>
                {
                    repoLink && (
                        <a
                            href={repoLink}
                            target="_blank"
                            rel="noopener noreferrer"
                            class="inline-flex items-center gap-1.5 text-xs font-medium text-gray hover:text-charcoal px-2 py-1.5 rounded-full hover:bg-light transition-colors">
                            <Image
                                height={14}
                                width={14}
                                src={GithubIcon}
                                alt="GitHub"
                            />
                            Code
                        </a>
                    )
                }
            </div>
        </div>
    </div>
</article>

<style>
    .line-clamp-2 {
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }
</style>
